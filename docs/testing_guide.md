# テストガイド

## 概要

電卓アプリケーションのテスト体系について説明します。DUnitXフレームワークを使用してユニットテストと統合テストを実装しています。

## テスト構成

### 1. ユニットテスト

**TestCalculatorEngine.pas**
- `TCalculatorEngine`クラスの個別機能テスト
- 計算ロジックの正確性検証
- エラーハンドリングの動作確認

#### 主要テストケース
- 基本四則演算（加算、減算、乗算、除算）
- ゼロ除算エラー処理
- 小数点計算
- 連続演算
- クリア機能

### 2. 統合テスト

**TestCalculatorForm.pas**
- UI操作とビジネスロジックの統合テスト
- ボタンクリックによる計算フロー検証
- 表示機能の動作確認

#### 主要テストケース
- ボタン入力による数値表示
- 基本計算操作
- クリア・クリアエントリ機能
- 小数点入力制御
- エラー表示

## テスト実行方法

### IDE内での実行
1. `tests/CalculatorTests.dproj`をDelphiで開く
2. プロジェクトをビルド
3. F9キーで実行

### コマンドライン実行
```batch
cd tests
run_tests.bat
```

### 手動実行
```batch
cd tests
dcc32 CalculatorTests.dpr
Win32\Debug\CalculatorTests.exe --format=console
```

## テスト結果の確認

### コンソール出力
- 実行されたテスト数
- 成功・失敗の結果
- 失敗時の詳細メッセージ

### XML出力（CI/CD用）
- NUnit互換のXMLレポート生成
- 自動化ツールとの連携が可能

## テストのメンテナンス

### 新機能追加時
1. 対応するテストケースを追加
2. エッジケースの考慮
3. エラーハンドリングのテスト

### バグ修正時
1. バグを再現するテストケースを先に作成
2. 修正後にテストが通ることを確認
3. リグレッションテストの実行

## 依存関係

- **DUnitX**: Delphiの標準テストフレームワーク
- **VCL**: UIテスト用のコンポーネント
- **CalculatorEngine**: テスト対象のビジネスロジック

## トラブルシューティング

### よくある問題

**Q: テストがビルドできない**
A: 以下を確認してください
- BDS環境変数の設定
- DUnitXライブラリのインストール
- ファイルパスの正確性

**Q: UIテストが失敗する**
A: 以下を確認してください
- フォームコンポーネントの初期化
- イベントハンドラの実装
- 表示更新のタイミング

**Q: 計算結果が期待値と異なる**
A: 以下を確認してください
- 浮動小数点の精度設定
- 演算順序の実装
- エラー状態の管理